"use strict";(globalThis.webpackChunkixl_webpack=globalThis.webpackChunkixl_webpack||[]).push([["commons-ixl_utils_ixlModal_IxlModal_jsx"],{913585:(t,e,o)=>{o.d(e,{Z:()=>b}),o(519693),o(684348),o(885991);var s=o(406042),i=o(642980),l=o(745247),r=o.n(l),a=o(103024),n=o.n(a),d=o(380742);o(574995);var h=o(547397);let p={open:r().bool,closeCallback:r().func,focusCallback:r().func,blurCallback:r().func,mouseLeaveCallback:r().func,showCloseButton:r().bool,closeButtonStyle:r().object,modalContentStyle:r().object,modalStyle:r().object,extraClassName:r().string,extraClassNameUnderlay:r().string,minMargin:r().number,zIndex:r().number,maskClosable:r().bool,hideMask:r().bool,closeButtonAriaLabelOverride:r().string,ariaLabelledBy:r().string,ariaDescribedBy:r().string,alignmentMode:r().string,targetNodeInfo:r().shape({domNode:r().any,offset:r().number.isRequired,preferredDirections:r().arrayOf(r().oneOf(["above","below","left","right"])).isRequired,onRenderCallback:r().func,crossAxisAlignToEdge:r().bool}),onKeyDown:r().func,dataCy:r().string,children:r().node.isRequired},c={open:!1,showCloseButton:!0,closeButtonStyle:{},modalContentStyle:{},modalStyle:{},extraClassName:"",extraClassNameUnderlay:"",minMargin:10,zIndex:1e3,maskClosable:!1,hideMask:!1,closeButtonAriaLabelOverride:"",ariaLabelledBy:"",ariaDescribedBy:"",alignmentMode:"center",targetNodeInfo:null,closeCallback:h.Z,focusCallback:h.Z,blurCallback:h.Z,mouseLeaveCallback:h.Z,onKeyDown:h.Z,dataCy:null};class m extends s.Component{constructor(t){super(t),this._onResize=this._onResize.bind(this),this._onEscape=this._onEscape.bind(this),this._onFocusPopover=this._onFocusPopover.bind(this),this._onBlurPopover=this._onBlurPopover.bind(this),this._onMouseLeavePopover=this._onMouseLeavePopover.bind(this),this._onMaskClose=this._onMaskClose.bind(this),this.forceResizePopover=this.forceResizePopover.bind(this),this._centerPopover=this._centerPopover.bind(this),this._setupTabs=this._setupTabs.bind(this),this._removeTabs=this._removeTabs.bind(this),this._controlTab=this._controlTab.bind(this),this._setModalRef=this._setModalRef.bind(this),this._setModalContentRef=this._setModalContentRef.bind(this),this._setUnderlayRef=this._setUnderlayRef.bind(this),this._setModalArrowRef=this._setModalArrowRef.bind(this)}componentDidMount(){window.addEventListener("resize",this._onResize),document.addEventListener("keydown",this._onEscape),this._setupTabs(),this._onResize()}componentWillUpdate(){this._removeTabs()}componentDidUpdate(){this._setupTabs(),this._onResize()}componentWillUnmount(){this._removeTabs(),window.removeEventListener("resize",this._onResize),document.removeEventListener("keydown",this._onEscape),document.body.classList.remove("prevent-ios-body-scroll")}_setupTabs(){let t=Array.prototype.slice.call(i.findDOMNode(this).querySelectorAll("a,input:not([type=hidden]):enabled,select,textarea,button:not([disabled]),.practice-audio-button:not([tabindex='-1'])")),e=(t=t.filter(t=>t.offsetHeight>0)).filter(t=>0===t.tabIndex),o=t.filter(t=>t.tabIndex>0);o.sort((t,e)=>t.tabIndex>e.tabIndex),this._tabOrder=e.concat(o);let s=this;this._tabOrder.forEach(t=>{t.addEventListener("keydown",s._controlTab)})}_removeTabs(){let t=this;this._tabOrder.forEach(e=>{e.removeEventListener("keydown",t._controlTab)})}_controlTab(t){if("Tab"===t.key){t.preventDefault();let e=this._tabOrder.indexOf(t.target);t.shiftKey?e--:e++,e<0&&(e=this._tabOrder.length-1),e>=this._tabOrder.length&&(e=0),this._tabOrder[e].focus()}}forceResizePopover(){this._positionPopover()}_positionPopover(){let t=this.props;"target-node"===t.alignmentMode&&t.targetNodeInfo&&t.targetNodeInfo.domNode?this._alignPopoverToTargetNode():this._centerPopover()}_alignPopoverToTargetNode(){let{preferredDirections:t,onRenderCallback:e}=this.props.targetNodeInfo,o={left:this._alignPopoverToTargetNodeLeft,right:this._alignPopoverToTargetNodeRight,above:this._alignPopoverToTargetNodeAbove,below:this._alignPopoverToTargetNodeBelow},s=!1;for(let i=0;i<t.length&&!s;i++){let l=t[i];(s=o[l].call(this))&&e&&e(l)}!s&&(o[t[0]].call(this,!0),e&&e(t[0]))}_alignPopoverToTargetNodeBelow(t){let{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,l=i.getBoundingClientRect(),r=this.modal.style.left?parseInt(this.modal.style.left):0,a=this.modal.style.top?parseInt(this.modal.style.top):0,n=e.getBoundingClientRect();if(n.bottom+l.height<=window.innerHeight&&this._modalFitsInCrossAxisDirection(l,n,!0,s,o)||t){let t=this._getCrossAxisAlignmentPoint(n,!0,s),e=l.left+l.width*o;i.style.left=`${r+Math.round(t-e)}px`;let d=n.bottom,h=l.top;i.style.top=`${a+Math.round(d-h)}px`;let p=this.modalArrow.style;return p.borderLeft="10px solid transparent",p.borderRight="10px solid transparent",p.borderTop="",p.borderBottom="5px solid #FFFFFF",p.top="-5px",p.bottom="",p.left=`calc(${100*o}% - 10px)`,p.right="",!0}}_alignPopoverToTargetNodeAbove(t){let{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,l=i.getBoundingClientRect(),r=this.modal.style.left?parseInt(this.modal.style.left):0,a=this.modal.style.top?parseInt(this.modal.style.top):0,n=e.getBoundingClientRect();if(n.top-l.height>=0&&this._modalFitsInCrossAxisDirection(l,n,!0,s,o)||t){let t=this._getCrossAxisAlignmentPoint(n,!0,s),e=l.left+l.width*o;i.style.left=`${r+Math.round(t-e)}px`;let d=n.top,h=l.bottom;i.style.top=`${a+Math.round(d-h)}px`;let p=this.modalArrow.style;return p.borderLeft="10px solid transparent",p.borderRight="10px solid transparent",p.borderTop="5px solid #FFFFFF",p.borderBottom="",p.top="",p.bottom="-5px",p.left=`calc(${100*o}% - 10px)`,p.right="",!0}}_alignPopoverToTargetNodeLeft(t){let{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,l=i.getBoundingClientRect(),r=this.modal.style.left?parseInt(this.modal.style.left):0,a=this.modal.style.top?parseInt(this.modal.style.top):0,n=e.getBoundingClientRect();if(n.left-l.width>=0&&this._modalFitsInCrossAxisDirection(l,n,!1,s,o)||t){let t=n.left,e=l.right;i.style.left=`${r+Math.round(t-e)}px`;let d=this._getCrossAxisAlignmentPoint(n,!1,s),h=l.top+l.height*o;i.style.top=`${a+Math.round(d-h)}px`;let p=this.modalArrow.style;return p.borderLeft="5px solid #FFFFFF",p.borderRight="",p.borderTop="10px solid transparent",p.borderBottom="10px solid transparent",p.top=`calc(${100*o}% - 10px)`,p.bottom="",p.left="",p.right="-5px",!0}}_alignPopoverToTargetNodeRight(t){let{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,l=i.getBoundingClientRect(),r=this.modal.style.left?parseInt(this.modal.style.left):0,a=this.modal.style.top?parseInt(this.modal.style.top):0,n=e.getBoundingClientRect();if(n.right+l.width<=window.innerWidth&&this._modalFitsInCrossAxisDirection(l,n,!1,s,o)||t){let t=n.right,e=l.left;i.style.left=`${r+Math.round(t-e)}px`;let d=this._getCrossAxisAlignmentPoint(n,!1,s),h=l.top+l.height*o;i.style.top=`${a+Math.round(d-h)}px`;let p=this.modalArrow.style;return p.borderLeft="",p.borderRight="5px solid #FFFFFF",p.borderTop="10px solid transparent",p.borderBottom="10px solid transparent",p.top=`calc(${100*o}% - 10px)`,p.bottom="",p.left="-5px",p.right="",!0}}_modalFitsInCrossAxisDirection(t,e,o,s,i){let l=o?window.innerWidth:window.innerHeight,r=o?t.width:t.height,a=this._getCrossAxisAlignmentPoint(e,o,s);return a+r*(1-i)<=l&&a-r*i>=0}_getCrossAxisAlignmentPoint(t,e,o){return e?t.left+(o?0:t.width/2):t.top+(o?0:t.height/2)}_centerPopover(){let t=document.documentElement.clientHeight,e=document.documentElement.clientWidth;this._lastHeight||(this._lastHeight=t),this._lastWidth||(this._lastWidth=e),/(android)/i.test(navigator.userAgent)&&(this._lastWidth===e&&3*this._lastHeight/4>t?this._androidKeyboardShown=!0:this._lastWidth===e&&4*this._lastHeight/3<t&&(this._androidKeyboardShown=!1)),this.modalContent.style.removeProperty("height"),this.modal.style.removeProperty("right"),this.modal.style.removeProperty("left"),this.modalContent.style.removeProperty("width");let o=this.modalContent.getBoundingClientRect(),s=this.underlay.getBoundingClientRect(),i=o.height,l=o.width,r=t-i,a=this.props.minMargin+(s.width-l)/2;r>2*a?(this.modal.style.top=`${r/2}px`,this.modal.style.removeProperty("bottom")):this._androidKeyboardShown?this.modal.style.top=`${a}px`:(this.modal.style.top=`${a}px`,this.modal.style.bottom=`${a}px`,this.modalContent.style.height=`${t-2*a}px`);let n=e-l;n>2*a?(this.modal.style.left=`${n/2}px`,this.modal.style.removeProperty("right")):(this.modal.style.left=`${a}px`,this.modal.style.right=`${a}px`,this.modalContent.style.width=`${e-2*a}px`),this._lastHeight=t,this._lastWidth=e}_setModalRef(t){this.modal=t}_setModalContentRef(t){this.modalContent=t}_setUnderlayRef(t){this.underlay=t}_setModalArrowRef(t){this.modalArrow=t}_onResize(){this.props.open&&this._positionPopover()}_onEscape(t){this.props.open&&"Escape"===t.key&&this.props.showCloseButton&&this.props.closeCallback()}_onFocusPopover(){this.props.focusCallback&&this.props.focusCallback()}_onBlurPopover(){this.props.blurCallback&&this.props.blurCallback()}_onMouseLeavePopover(){this.props.mouseLeaveCallback&&this.props.mouseLeaveCallback()}_onMaskClose(t){this.props.maskClosable&&t.currentTarget===t.target&&this.props.closeCallback()}render(){let t=null;this.props.showCloseButton&&(t=s.createElement(d.xR,null,t=>{let{getI18nMessage:e}=t;return s.createElement("button",{className:"modal-close","data-cy":"ixl-modal-close",style:this.props.closeButtonStyle,onClick:this.props.closeCallback,"aria-label":this.props.closeButtonAriaLabelOverride||e("ixl_modal.close")})}));let e={display:this.props.open?"block":"none",zIndex:this.props.zIndex},o=n()(["ixl-modal-outer-container",this.props.extraClassName,this.props.alignmentMode],{hidden:this.props.hideMask}),i={zIndex:this.props.zIndex},l=n()(["ixl-modal-mask"],{hidden:this.props.hideMask}),r={zIndex:this.props.zIndex+1};Object.assign(r,this.props.modalStyle);let a=n()({"ixl-modal":!0});return s.createElement("div",{className:o,onKeyDown:this.props.onKeyDown,style:e},s.createElement("div",{className:l,style:i,onClick:this._onMaskClose}),s.createElement("div",{className:a,style:r,role:"dialog","aria-labelledby":this.props.ariaLabelledBy,"aria-describedby":this.props.ariaDescribedBy,onFocus:this._onFocusPopover,onBlur:this._onBlurPopover,onMouseLeave:this._onMouseLeavePopover,tabIndex:-1,ref:this._setModalRef,"data-state":this.props.open?"open":"closed","data-cy":this.props.dataCy},s.createElement("div",{className:"ixl-modal-arrow",ref:this._setModalArrowRef}),s.createElement("div",{className:"ixl-modal-container","data-cy":"ixl-modal-container"},s.createElement("div",{className:"ixl-modal-inside"},s.createElement("div",{className:"ixl-modal-content",style:this.props.modalContentStyle,ref:this._setModalContentRef},this.props.children)),t),s.createElement("div",{className:this.props.extraClassNameUnderlay?this.props.extraClassNameUnderlay:"ixl-modal-underlay",ref:this._setUnderlayRef})))}}m.propTypes=p,m.defaultProps=c;let b=m}}]);